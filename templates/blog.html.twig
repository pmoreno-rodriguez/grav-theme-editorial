{% extends 'partials/base.html.twig' %}

{% set collection = page.collection() %}
{% set blog = page.find(header_var('blog_url')|defined(theme_var('blog-page'))) %}
{% set show_pagination = header_var('show_pagination', [page, blog])|defined(true) %}

{# Set the listing_title for category, tag and author  #}
{% set listing_title_category = theme_var('listing_title.taxonomy.category')|raw|defined('Posts in Category: ') %}
{% set listing_title_tag = theme_var('listing_title.taxonomy.tag')|defined('Posts with Tag: ') %}
{% set listing_title_author = theme_var('listing_title.taxonomy.author')|defined('Posts written by Author: ') %}

{# Set page title by taxonomy #}
{% if uri.param('category') %}
	{% set page_title = listing_title_category ~ uri.param('category') %}
{% elseif uri.param('tag') %}
	{% set page_title = listing_title_tag ~ uri.param('tag') %}
{% elseif uri.param('author') %}
	{% set page_title = listing_title_author ~ uri.param('author') %}
{% else %}
	{% set page_title = theme_var('listing_title.blog')|default('Blog') %}
{% endif %}

{% block content %}

    <p>
    {% if show_breadcrumbs and config.plugins.breadcrumbs.enabled %}
        {% include 'partials/breadcrumbs.html.twig' %}
    {% endif %}
    </p>
    <header class="main">
        <h1>{{page_title}}</h1>
        {% if page.header.subtitle %}<p>{{ page.header.subtitle|raw }}</p>{% endif %}
    </header>
        
        <div class="posts">
            {% for child in collection %}
                {% include 'partials/blog-list-item.html.twig' with {blog: page, page: child} %}
            {% endfor %}
        </div>
        {# Render the pagination list #}
    {% if show_pagination and config.plugins.pagination.enabled and collection.params.pagination %}
        <div class="align-center">
            {% include 'partials/pagination.html.twig' with {'base_url':page.url, 'pagination':collection.params.pagination} %}
        </div>
    {% endif %}

{% endblock %}